
<div class="feedback-container">
  <mat-tab-group>

    <!-- ** Reviews Section ** -->

    <mat-tab label="Ratings"> 

      <mat-card  class="mat-mdc-card mdc-card cardWithShadow">
        <mat-card-content  class="mat-mdc-card-content p-24">
          
          <div *ngIf="loggedIn()">

            <!-- ** Add Review Form ** -->

            <mat-card-title  class="mat-mdc-card-title m-b-24 f-s-21">{{ myRating? "Your Review" : "Add Your Review!" }} </mat-card-title>

            <div *ngIf="!myRating || editingReview" class="ng-untouched ng-pristine ng-valid">
              <p-rating
                [(ngModel)]="ratingRequest.NumberOfStars"
                name="stars"
                [cancel]="false"
                [readonly]="false"
                [stars]="5"
              >
              </p-rating>
                
              <div appearance="outline" class="mat-primary w-100  ng-star-inserted">
                <mat-form-field  appearance="outline" class=" w-100  ng-star-inserted" >
                  <textarea matInput rows="4" [(ngModel)]="ratingRequest.content" 
                    aria-required="false" aria-invalid="false" 
                  >
                  </textarea>
                </mat-form-field>
              </div>

              <button (click)="submitReview()" mat-flat-button="" color="primary" class="mat-primary mat-mdc-button-base" >
                <span> Submit </span>
              </button>
            </div>

            <!-- ** User Review if exists ** -->

            <div *ngIf="myRating && !editingReview " class="bg-light rounded p-24 m-t-24">

              <div style="float:right">
                <button mat-icon-button (click)="editReview()" matTooltip="Edit" matTooltipPosition="below">
                  <i-tabler name="edit"  style="font-size: 1rem"></i-tabler>
                </button>
                <button mat-icon-button (click)="deleteReview()" color="warn" matTooltip="Delete" matTooltipPosition="below">
                  <i-tabler name="trash-x"  style="font-size: 1rem"></i-tabler>
                </button>
              </div>
              
              <div class="d-flex align-items-center">
                <img src="/assets/images/profile/user-1.jpg" alt="user" width="35" class="rounded-circle">
                <span class="mat-body-2 f-w-600 m-l-12"> {{ myUser.firstName + ' ' +  myUser.lastName }} </span>
                <span class="m-l-12 f-s-12 d-flex align-items-center">
                  <i-tabler name="circle-filled" class="icon-7 op-5 d-flex m-r-4"> </i-tabler> 
                  {{myRating.createdAt | date:"dd-MM-yyyy"}}
                </span>
                <div style="margin-left: 10px;">
                  <p-rating [(ngModel)]="myRating.numberOfStars" [disabled]="true" [cancel]="false"></p-rating>
                </div>
              </div>

              <p class="mat-body-1 m-t-16"> 
                {{ myRating.content }}
              </p>

            </div>
          </div>


          <!-- ** Others Reviews ** -->

          <mat-card-title class="mat-mdc-card-title m-t-30 f-s-21 p-t-24">
            Users Reviews 
            <span class="text-primary p-x-12 p-y-8 rounded bg-light-primary f-w-600 m-l-8 f-s-18"> {{ ratings.length }} </span>
          </mat-card-title>

          <div *ngFor="let rating of ratings" class="bg-light rounded p-24 m-t-24">
            <div class="d-flex align-items-center">
              <img src="/assets/images/profile/user-2.jpg" alt="user" width="35" class="rounded-circle">
              <span class="mat-body-2 f-w-600 m-l-12"> {{ rating.user.firstName + ' ' +  rating.user.lastName }} </span>
              <span class="m-l-12 f-s-12 d-flex align-items-center">
                  <i-tabler name="circle-filled" class="icon-7 op-5 d-flex m-r-4"> </i-tabler> 
                  {{rating.createdAt | date:"dd-MM-yyyy"}}
              </span>
              <div style="margin-left: 10px;">
                <p-rating [(ngModel)]="rating.numberOfStars" [disabled]="true" [cancel]="false"></p-rating>
              </div>
            </div>

            <p class="mat-body-1 m-t-16"> 
              {{ rating.content }}
            </p>
            
          </div>
        </mat-card-content>
      </mat-card>
    </mat-tab>


    <!-- ** Comments Section ** -->

    <mat-tab label="Comments"> 

      <mat-card  class="mat-mdc-card mdc-card cardWithShadow">
        <mat-card-content  class="mat-mdc-card-content p-24">
        
          <div *ngIf="loggedIn()">

            <mat-card-title class="mat-mdc-card-title m-b-24 f-s-21">Post a Comment!</mat-card-title>
            
            <div class="ng-untouched ng-pristine ng-valid">
              <div  appearance="outline" class="mat-primary w-100 mat-mdc-form-field ng-star-inserted">
                <mat-form-field  appearance="outline" class="mat-mdc-form-field w-100  ng-star-inserted" >
                  <textarea  matInput rows="4" [(ngModel)]="commmentInput"  aria-invalid="false" aria-required="false"
                    class="mat-mdc-input-element  " 
                    >
                  </textarea>
                </mat-form-field>
              </div>

              <button mat-flat-button="" color="primary" class="mat-primary mat-mdc-button-base" >
                <span >Post</span>
              </button>
            </div>
          </div>

          <mat-card-title class="mat-mdc-card-title m-t-30 f-s-21 p-t-24">
            Comments 
            <span class="text-primary p-x-12 p-y-8 rounded bg-light-primary f-w-600 m-l-8 f-s-18">4</span>
          </mat-card-title>

          <div class="bg-light rounded p-24 m-t-24">
            <div class="d-flex align-items-center">
            <img src="/assets/images/profile/user-2.jpg" alt="user" width="35" class="rounded-circle">
            <span class="mat-body-2 f-w-600 m-l-12">Charlie Hamilton</span>
            <span class="m-l-12 f-s-12 d-flex align-items-center">
                <i-tabler  name="circle-filled" class="icon-7 op-5 d-flex m-r-4"> </i-tabler> now
            </span>
            </div>
            
            <p class="mat-body-1 m-t-16"> 
              Jigho tabkubho nira carudi ganlac milza dekpo putog iptodok tuhral canse mi rega ujnuf kukfag osailu bis oca. Gegeholo hata sogi kod bihdelsa nege evinog mes loz perdutace kehlondip im fep wiven fefu fi tigfiso. 
            </p>
            
            <button *ngIf="loggedIn()" mat-mini-fab mattooltip="Reply" color="primary"
              class="icon-30 m-t-16 mat-primary" 
            >
              <i-tabler name="arrow-back-up" class="icon-18"> </i-tabler>
            </button>
          </div>

          <div *ngIf="loggedIn()">
            <div class="d-flex align-items-center m-y-24">
              <img src="/assets/images/profile/user-1.jpg" alt="user" width="35" class="rounded-circle">
              
              <div appearance="outline" class="mat-mdc-form-field w-100 hide-hint m-l-16 mat-mat-primary mdc-mat-inputng">
                <mat-form-field  appearance="outline" class="mat-mdc-form-field w-100  ng-star-inserted" >
                  <textarea  matInput rows="1" [(ngModel)]="commmentInput"  aria-invalid="false" aria-required="false"
                    class="mat-mdc-input-element  non-resizable" 
                    >
                  </textarea>
                </mat-form-field>            
              </div>
              
              <button  mat-flat-button color="primary" class="m-l-16 mdc-button mat-primary">
                <span >Reply</span>
              </button>
              
            </div>
          </div>
        
        </mat-card-content>
      </mat-card>

    </mat-tab>
  </mat-tab-group>

</div>



